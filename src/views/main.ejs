<%
    // get animation style and keyframes
    textAnimation = getAnimation(textAnimation) 
%>
<%# SVG definition %>
<svg xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    version="1.1"
    width="<%= width %>"
    height="<%= height %>"
    viewBox="0 0 <%= width %> <%= height %>"
    style="<%=`
    background:${backgroundColor};
    `%>">

    <style>
        /* SVG STYLE */
        :root {
            --glow-color: <%= glowColor %>;
            --title-font-size: <%= titleFontSize %>px;
            --title-color:  <%= titleColor %>;
            --subtitle-font-size: <%= subtitleFontSize %>px;
            --subtitle-color: <%= subtitleColor %>;
            --border-color: <%= borderColor %>;
            --border-opacity: <%=borderOpacity%>%;
            --border-width: 10px;
            --text-font-family: 'Franklin Gothic', Arial, sans-serif;
            --text-font-weight: bold;
        }
        <%- include('title/css') %>
        <%- include('subtitle/css')%>
        <%- include('frameborder/css')%>
        
        .main-stop {
            stop-color: red;
        }
        .alt-stop {
            stop-color: green;
        }

        .abc {
            animation: glowing 20s linear infinite;
        }

        @keyframes glowing {
            0% { x: 0 0; }
            50% { x: 400% 0; }
            100% { x: 0 0; }
        }


        <%= textAnimation.keyframes %>
    </style>

    <!-- frame border -->
    <%- include('frameborder/show') %> 

    <defs>
        <!-- Define the gradient for the border -->
        <linearGradient id="rainbowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stop-color="red">
              <animate attributeName="stop-color" values="red;orange;yellow;green;blue;indigo;violet;red" dur="10s" repeatCount="indefinite" />
          </stop>
          <stop offset="20%" stop-color="orange">
              <animate attributeName="stop-color" values="orange;yellow;green;blue;indigo;violet;red;orange" dur="10s" repeatCount="indefinite" />
          </stop>
          <stop offset="40%" stop-color="yellow">
              <animate attributeName="stop-color" values="yellow;green;blue;indigo;violet;red;orange;yellow" dur="10s" repeatCount="indefinite" />
          </stop>
          <stop offset="60%" stop-color="green">
              <animate attributeName="stop-color" values="green;blue;indigo;violet;red;orange;yellow;green" dur="10s" repeatCount="indefinite" />
          </stop>
          <stop offset="80%" stop-color="blue">
              <animate attributeName="stop-color" values="blue;indigo;violet;red;orange;yellow;green;blue" dur="10s" repeatCount="indefinite" />
          </stop>
          <stop offset="100%" stop-color="indigo">
              <animate attributeName="stop-color" values="indigo;violet;red;orange;yellow;green;blue;indigo" dur="10s" repeatCount="indefinite" />
          </stop>
      </linearGradient>
    
      <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur in="SourceGraphic" stdDeviation="3" />
      </filter>
    </defs>

    <%# texts backgrounds %>
    
    <!-- title background -->
    <% var titleBgWidth = (title.length * (+titleFontSize / 1.5))  %>
    <% var titleBgHeight = +titleFontSize + 10 %>
        
    <%- include('titleBackground/border', { titleBgWidth, titleBgHeight }) %> 
    <%- include('titleBackground/show', { titleBgWidth, titleBgHeight }) %> 

    <!-- subtitle background -->
    <% var subtitleBgWidth = (subtitle.length * (+subtitleFontSize / 1.5))  %>
    <% var subtitleBgHeight = +subtitleFontSize + 10 %>

    <rect width="<%= subtitleBgWidth %>" 
        height="<%= subtitleBgHeight %>"
        x="<%= subtitlePositionX %>%"
        y="<%= subtitlePositionY %>%"
        fill="<%= subtitleBgColor %>"
        opacity="<%= subtitleBgOpacity %>%"
        rx="15" ry="15"
        transform="translate(-<%= subtitleBgWidth / 2 %>, -<%= subtitleBgHeight / 2 %>)"
    />

    <%# title definition %>
    <%- include('title/show') %> 
    
    <%# subtitle definition %>
    <%- include('subtitle/show') %> 
    
</svg>